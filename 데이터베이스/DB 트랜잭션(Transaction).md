# 트랜잭션

## 트랜잭션이란 ?

트랜잭션(Transaction)은 데이터베이스의 상태를 변환시키는 하나의 논리적 기능 (예 : Update, Delete)을 수행하기 위한 작업의 단위 혹은 일련의 연산들을 말한다.

## 트랜잭션의 특성

트랜잭션은 ACID라는 네 가지 특성을 만족해야 한다.

### 원자성 (Atomicity)

트랜잭션은 데이터베이스에 모두 반영되거나 전혀 반영되지 않아야 한다. 
즉, 트랜잭션 내의 모든 명령은 반드시 완벽하게 수행되어야 하며, 어느 하나라도 오류가 발생하면 트랜잭션 전부가 취소되어야 한다.

### 일관성 (Consistency)

트랜잭션이 성공적으로 완료되면 일관성 있는 데이터베이스 상태로 변환된다.
시스템이 가지고 있는 고정 요소는 트랜잭션 수행 전과 수행 후의 상태가 같아야한다는 말로, 데이터베이스의 제약 조건을 만족해야 한다.

### 고립성 (Isolation)

둘 이상의 트랜잭션이 동시에 병행 실행되고 있을 때, 어떤 트랜잭션도 다른 트랜잭션의 연산에 끼어들 수 없다.

### 지속성 (Durability)

성공적으로 완료된 트랜잭션의 결과는 시스템이 고장나더라도 영구적으로 반영되어야 한다.

## 트랜잭션의 상태

![img.png](<images/transaction/transactionstatus.png>)

### 활성 (Active)

트랜잭션이 실행 중인 상태

### 실패 (Failed)

트랜잭션 실행에 오류가 발생하여 중단된 상태

### 부분 완료 (Partially Committed)

트랜잭션이 성공적으로 실행되었지만, Commit 연산이 실행되기 직전의 상태

### 철회 (Aborted)

트랜잭션이 실패한 후 Rollback 연산을 수행하여 트랜잭션이 중단된 상태

### 완료 (Committed)

트랜잭션이 성공적으로 실행되어 Commit 연산을 실행한 후의 상태




## 트랜잭션의 연산

트랜잭션은 다음과 같은 연산으로 구성된다.

### 커밋 (Commit)

트랜잭션의 실행이 성공적으로 완료되었음을 데이터베이스에 알리는 연산

### 롤백 (Rollback)

트랜잭션의 실행이 실패하였을 때, 트랜잭션이 실행되기 이전의 상태로 되돌리는 연산

트랜잭션이 수행되는 도중 일부 연산이 처리되지 못한 상황이라면 ROLLBACK 연산을 실행하여 트랜잭션 수행이 실패했음을 선언하고, 
DB를 트랜잭션 수행 전과 일관된 상태로 되돌려야 한다.

## 트랜잭션 사용시 주의사항

트랜잭션은 꼭 필요한 최소한의 코드에만 적용하는 것이 좋다. 즉, 트랜잭션의 범위를 최소화하라는 말이다.

일반적으로 DB 커넥션은 개수가 제한적이다. 
그런데 각 단위 프로그램이 커넥션을 소유하는 시간이 길어지면, 사용 가능한 여유 커넥션의 개수는 줄어들게 된다. 
그러다 어느 순간에는 각 단위 프로그램에서 커넥션을 가져가기 위해 기다려야 하는 상황이 발생할 수 있기 때문이다.

---
## 질문
1. 트랜잭션의 4가지 특징에 대해 설명해주세요
2. 트랜잭션 상태중 Partially Committed 상태에 대해 설명해주세요
3. 트랜잭션의 연산중 커밋과 롤백에 대해 설명해주세요

---
## 참고 자료
[[DB] 트랜잭션 (Transaction) with 4가지 특성](https://jindevelopetravel0919.tistory.com/48)
[[Database] 트랜잭션 정리](https://velog.io/@shasha/Database-%ED%8A%B8%EB%9E%9C%EC%9E%AD%EC%85%98-%EC%A0%95%EB%A6%AC)
[DB 트랜잭션(Transaction)
](https://gyoogle.dev/blog/computer-science/data-base/Transaction.html)
