# 로드 밸런싱(Load Balancing)

## 목차
1. [로드 밸런싱이란?](#로드-밸런싱이란)
2. [로드 밸런싱 알고리즘](#로드-밸런싱-알고리즘)
3. [L4 로드 밸런싱](#l4-로드-밸런싱)
4. [L7 로드 밸런싱](#l7-로드-밸런싱)

---

### 로드 밸런싱이란?

> 로드 밸런싱은 서버에 가해지는 부하(=로드)를 분산(=밸런싱)해주는 장치 또는 기술이다.

로드 밸런싱을 통해 컴퓨터 자원들에게 작업을 나눠줌으로써 애플리케이션을 지원하는 리소스 풀 전체에 네트워크 트래픽을 균등하게 배포할 수 있다.
<br></br>
![image](https://github.com/user-attachments/assets/d407f1fc-e73a-4742-9864-469b81b4c57f)

서비스 규모가 확장되고, 클라이언트의 수가 늘어나게 되면 기존 서버만으로는 정상적인 서비스가 불가능하게 된다. <br>
이때, 증가한 트래픽에 대처할 수 있는 방법은 크게 두 가지이다.

(1) **Scale up**: 서버(하드웨어) 자체의 성능을 높이는 것
  - 물리적으로 증가하는 데 한계가 있다.
  - 비용적으로 부담될 수 있다.
  
(2) **Scale out**: 여러 대의 서버를 두는 것
  - 동일한 작업을 수행하는 여러 개의 비슷한 용량의 서버를 수평적으로 늘려 로드 밸런싱을 통해 트래픽을 분산한다.
  - 관리해야 할 서버의 개수가 늘어날수록 관리하는 데에 많은 리소스가 투입된다.
  - 여러 대의 서버로 분산 처리되기 때문에 장애 발생 확률이 단일 서버보다 적다.

이때, `Scale-out`의 방식은 여러 대의 서버로 트래픽을 균등하게 분산해주는 로드 밸런싱이 반드시 필요하다.

---

### 로드 밸런싱 알고리즘

- **라운드로빈**
  - 서버에 들어온 요청을 순서대로 돌아가며 배정하는 방식이다.
  - 여러 대의 서버 성능이 비슷하고 서버와의 연결이 오래 지속되지 않는 경우 적합하다.

- **가중 라운드로빈 방식**
  - 각 서버에 가중치를 매기고 가중치가 높은 서버에 요청을 우선적으로 배정하는 방식이다.
  - 서버의 트래픽 처리 능력이 다른 경우 적합하다.

- **최소 연결 방식**
  - 요청이 들어온 시점에 가장 적은 연결 상태를 보이는 서버에 트래픽을 배정하는 방식이다.
  - 서버의 트래픽들이 일정하지 않거나 세션이 길어지는 경우에 적합하다.

- **IP 해시 방식**
  - 클라이언트의 IP 주소를 특정 서버로 매핑하여 요청을 처리하는 방식이다.
  - 특정 사용자가 항상 동일한 서버로 연결되는 것을 보장한다.

---

### L4 로드 밸런싱

- 트랜스포트 계층에서 로드를 분산한다.
- TCP, UDP 포트 정보를 바탕으로 동작한다.
- 데이터 안을 보지 않고 패킷 레벨에서만 로드를 분산하기 때문에 속도가 빠르고 효율이 높다.
- 섬세한 라우팅이 불가능하지만 L7 로드 밸런서보다 저렴하다.

### L7 로드 밸런싱

- 애플리케이션 계층에서 로드를 분산한다.
- HTTP 헤더, 쿠키 등과 같은 사용자 요청을 기준으로 특정 서버에 트래픽을 분산하는 것이 가능하다. <br>
  즉, 패킷 내용을 확인하고 그 내용에 따라 로드를 특정 서버에 분배할 수 있다.
- 섬세한 라우팅이 가능하고, 비정상적인 트래픽을 필터링할 수 있다.
- 패킷의 내용을 복호화해야 하기 때문에 더 많은 비용이 든다.

---

### ❓ 질문

Q1. 대용량 트래픽 이슈가 발생했을 때 대처 방법에 대해 설명해주세요.

Q2. 로드 밸런싱에 대해 설명해주세요.

Q3. 로드 밸런싱 알고리즘 중 대표적인 라운드 로빈과 최소 연결 방식에 대해 설명해주세요.

---
### 📚 참고자료
[AWS - 로드 밸런싱](https://aws.amazon.com/ko/what-is/load-balancing/)
